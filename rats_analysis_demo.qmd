---
title: "NYC 311 Rodent Complaints: Demographics & Reporting Propensity Analysis"
subtitle: "Investigating Reporting Bias in Urban Pest Management Data"
author: "Rachel Cutsumpas"
date: today
format: 
  html:
    theme: cosmo
    toc: true
    toc-depth: 3
    toc-location: left
    code-fold: true
    code-summary: "Show Code"
    code-tools: true
    number-sections: true
    fig-width: 10
    fig-height: 7
    embed-resources: true
execute:
  echo: false
  error: false
  warning: false
  message: false
editor: visual
---
```{r setup}
#| include: false

# Suppress warnings globally
options(warn = -1)

# Load packages
library(httr2)
library(jsonlite)
library(dplyr)
library(tidyverse)
library(sf)
library(purrr)
library(corrplot)
library(ggplot2)
library(car)
library(knitr)
library(kableExtra)

# Create directories
dir.create("data/final", showWarnings = FALSE, recursive = TRUE)
dir.create("plots", showWarnings = FALSE, recursive = TRUE)

# Set theme
theme_set(theme_minimal(base_size = 12))
```

## Executive Summary {.unnumbered}

::: {.callout-note icon=false}
## Research Question
**To what extent are 311 rodent complaints a measure of human reporting behavior rather than objective rat conditions?**

This analysis examines whether demographic factors influence the likelihood of NYC residents filing 311 rodent complaints, independent of actual rat presence. The demographics factors analyzed include: language barriers, nativity (US born vs born in a different country), income, education level, and population density.
:::

**Key Findings:**

Analysis of 166 NYC neighborhoods reveals that demographic characteristics explain **18.8%** of the variance in 311 rodent complaint rates, providing evidence of systematic reporting bias. This finding demonstrates that where complaints originate reflects not only where rats are present, but also which communities are more likely to report them through official channels.

**What is Systematic Reporting Bias?**

Systematic reporting bias occurs when certain demographic groups consistently under- or over-report problems to official systems like 311, independent of the actual severity of those problems. In the context of rodent complaints, this means:

- Two neighborhoods with identical rat populations may generate vastly different complaint volumes
- Complaint data systematically overestimates problems in some areas while underestimating them in others
- Resource allocation based solely on complaint volume will systematically favor neighborhoods with higher reporting propensity

**Our Specific Findings:**

The regression analysis reveals a critical difference:

- **Higher Education** (% with Bachelor's degree or higher) significantly **increases** complaint rates (p = 0.002)
  - *Interpretation*: More educated residents may be more civically engaged, more aware of 311, or have higher expectations for government responsiveness
  
- **Higher Income** significantly **decreases** complaint rates (p < 0.001)
  - *Interpretation*: Wealthier residents may use private pest control, live in better-maintained buildings, or solve problems through property management rather than 311

- **English Language Proficiency** and **population density** showed no significant effects (p > 0.05)
  - *Interpretation*: Contrary to common assumptions, language barriers may not be the primary driver of reporting disparities

*This 18.8% explained variance represents a substantial bias that cannot be ignored when using 311 data for research, policy, or resource allocation decisions.*

**Implications:**

- **For Policy**: 311 complaint data should not be used as the sole indicator of pest control needs, as it systematically underrepresents lower-income, less-educated communities
- **For Research**: Reporting propensity scores can adjust for demographic bias in complaint-based urban pest studies
- **For Equity**: Proactive monitoring and multilingual outreach are essential to ensure equitable pest control services across all NYC neighborhoods


![](https://static.scientificamerican.com/dam/m/3d69b4a15659f8b7/original/rat_on_subway_platform.jpg?m=1757711008.193&w=900)

## Introduction

311 complaint data is commonly used as a proxy for urban pest prevalence. However, this assumes equal reporting propensity across all neighborhoods. This study tests whether demographic characteristics create systematic reporting bias that could lead to misallocation of pest control resources.

### Analytical Framework

We divide factors influencing 311 complaint rates into two categories:

1. **Objective Rat Conditions** (Rat Ecology + Environment): Actual rat presence and activity
2. **Reporting Behavior/Reporting Bias**: Demographic-driven likelihood to file complaints

Our analysis focuses on the second category, creating a **Reporting Propensity Score** that estimates reporting likelihood based solely on demographics.
```{r download-311-data}
#| include: false

get_rat311 <- function(n_max = 10000) {
  cache_file <- "data/final/rat311_cache.rds"
  
  if (file.exists(cache_file)) {
    return(readRDS(cache_file))
  }
  
  base_url <- "https://data.cityofnewyork.us/resource/cvf2-zn8s.geojson"
  limit <- min(n_max, 50000L)
  
  resp <- request(base_url) |>
    req_url_query("$limit" = limit) |>
    req_timeout(600) |>
    req_perform()
  
  resp_check_status(resp)
  raw_json <- resp_body_string(resp)
  gj <- fromJSON(raw_json, flatten = TRUE)
  rat_raw <- gj$features |> as_tibble()
  
  saveRDS(rat_raw, cache_file)
  return(rat_raw)
}

rat311_raw <- get_rat311(n_max = 10000)
```
```{r download-nta}
#| include: false

nta_path <- "docs/nta_2020.geojson"

if (!file.exists(nta_path)) {
  stop("NTA 2020 file not found. Please ensure nta_2020.geojson is in the docs folder.")
}

nta <- st_read(nta_path, quiet = TRUE) |> st_transform(4326)
```

```{r check-nta-columns}
#| include: false

cat("All columns in NTA spatial file:\n")
print(names(nta))
cat("\n")

# Show first row of non-geometry columns
cat("Sample of all columns (first row):\n")
sample_row <- nta[1, ] %>% st_drop_geometry()
print(sample_row)
```

```{r spatial-conversion}
#| include: false

rat_coords <- rat311_raw |>
  mutate(
    lon = as.numeric(properties.longitude),
    lat = as.numeric(properties.latitude)
  ) |>
  drop_na(lon, lat)

rats_sf <- st_as_sf(rat_coords, coords = c("lon", "lat"), crs = 4326)
```

```{r spatial-join}
#| include: false

# Use specific column names instead of positions
rats_with_nta <- st_join(rats_sf, nta %>% select(nta2020, ntaname))
rats_with_nta_df <- rats_with_nta |> st_drop_geometry()
```

```{r aggregate-complaints}
#| include: false

complaints_by_nta <- rats_with_nta_df %>%
  filter(!is.na(nta2020)) %>%
  group_by(nta2020, ntaname) %>%
  summarise(complaint_count = n(), .groups = 'drop') %>%
  rename(nta_2020_code = nta2020,
         nta_name = ntaname)
```

```{r download-demographics}
#| include: false

demo_path <- "docs/rodent_analysis/demo_2016acs5yr_nta.csv"
econ_path <- "docs/rodent_analysis/econ_2016acs5yr_nta.csv"
soc_path <- "docs/rodent_analysis/soc_2016acs5yr_nta.csv"

demographics <- if (file.exists(demo_path)) read.csv(demo_path, stringsAsFactors = FALSE) else data.frame()
economics <- if (file.exists(econ_path)) read.csv(econ_path, stringsAsFactors = FALSE) else data.frame()
sociological <- if (file.exists(soc_path)) read.csv(soc_path, stringsAsFactors = FALSE) else data.frame()
```

```{r clean-demographics}
#| include: false

if (nrow(demographics) > 0) {
  
  demo_clean <- demographics %>%
    filter(GeoType == "NTA2010") %>%
    select(nta_code = GeoID, nta_name = GeogName, total_pop = Pop_1E) %>%
    mutate(total_pop = as.numeric(gsub(",", "", total_pop))) %>%
    distinct(nta_code, .keep_all = TRUE)
  
  if (nrow(economics) > 0) {
    econ_clean <- economics %>%
      filter(GeoType == "NTA2010") %>%
      select(nta_code = GeoID, median_income = MdHHIncE) %>%
      mutate(median_income = as.numeric(gsub(",", "", median_income))) %>%
      distinct(nta_code, .keep_all = TRUE)
    
    demo_clean <- demo_clean %>%
      left_join(econ_clean, by = "nta_code", relationship = "many-to-many")
  }
  
  if (nrow(sociological) > 0) {
    soc_clean <- sociological %>%
      filter(GeoType == "NTA2010") %>%
      select(nta_code = GeoID, lang_other_english = LgOEng1E,
             foreign_born = Fb1E, bachelors = EA_BchDE) %>%
      mutate(across(c(lang_other_english, foreign_born, bachelors),
                   ~ as.numeric(gsub(",", "", .)))) %>%
      distinct(nta_code, .keep_all = TRUE)
    
    demo_clean <- demo_clean %>%
      left_join(soc_clean, by = "nta_code", relationship = "many-to-many")
  }
  
  demo_clean <- demo_clean %>%
    mutate(
      pct_foreign_born = (foreign_born / total_pop) * 100,
      pct_english_only = 100 - ((lang_other_english / total_pop) * 100),
      pct_bachelors = (bachelors / total_pop) * 100
    )
  
  demo_by_nta <- demo_clean %>%
    filter(!is.na(total_pop), total_pop > 0, !is.na(nta_code)) %>%
    distinct(nta_code, .keep_all = TRUE)
  
} else {
  demo_by_nta <- data.frame()
}
```

```{r create-name-crosswalk}
#| include: false

# Create approximate crosswalk by matching NTA names
nta_2020_names <- nta %>%
  st_drop_geometry() %>%
  select(nta_2020_code = nta2020, nta_2020_name = ntaname) %>%
  distinct()

# Try exact name matching
demo_with_2020_codes <- demo_by_nta %>%
  left_join(nta_2020_names, by = c("nta_name" = "nta_2020_name"))

matches <- sum(!is.na(demo_with_2020_codes$nta_2020_code))

# Keep only matched ones and rename ONCE
demo_by_nta <- demo_with_2020_codes %>%
  filter(!is.na(nta_2020_code)) %>%
  select(-nta_code) %>%
  rename(nta_code = nta_2020_code) %>%
  distinct(nta_code, .keep_all = TRUE)  # ← ADD THIS to remove any duplicates

cat("Final demographics with NTA 2020 codes:", nrow(demo_by_nta), "rows\n")
```

```{r calculate-density}
#| include: false

cat("=== CALCULATE DENSITY ===\n")
cat("demo_by_nta rows before:", nrow(demo_by_nta), "\n")

# Calculate areas using NTA 2020 codes
nta_areas <- nta %>%
  mutate(
    area_sq_m = as.numeric(st_area(geometry)),
    area_sq_miles = area_sq_m / 2589988.11
  ) %>%
  st_drop_geometry() %>%
  select(nta_code = nta2020, area_sq_miles)

cat("nta_areas rows:", nrow(nta_areas), "\n")
cat("Sample nta_areas codes:", paste(head(nta_areas$nta_code, 3), collapse = ", "), "\n")
cat("Sample demo codes:", paste(head(demo_by_nta$nta_code, 3), collapse = ", "), "\n\n")

# Join
demo_by_nta <- demo_by_nta %>%
  left_join(nta_areas, by = "nta_code") %>%
  mutate(pop_density = total_pop / area_sq_miles)

cat("demo_by_nta rows after:", nrow(demo_by_nta), "\n")
cat("Non-NA pop_density:", sum(!is.na(demo_by_nta$pop_density)), "\n")
```

```{r merge-data}
#| include: false

cat("=== MERGE DIAGNOSTICS ===\n")
cat("Starting with demo_by_nta:", nrow(demo_by_nta), "rows\n")
cat("Complaints:", nrow(complaints_by_nta), "rows\n\n")

# Join
analysis_data <- demo_by_nta %>%
  left_join(complaints_by_nta, by = c("nta_code" = "nta_2020_code"))

cat("After join:", nrow(analysis_data), "rows\n")

# Add complaint rate
analysis_data <- analysis_data %>%
  mutate(
    complaint_count = replace_na(complaint_count, 0),
    complaints_per_1000 = (complaint_count / total_pop) * 1000
  )

cat("After calculating rates:", nrow(analysis_data), "rows\n\n")

# Check for NAs before filtering
cat("NA counts:\n")
cat("  total_pop:", sum(is.na(analysis_data$total_pop)), "\n")
cat("  pop_density:", sum(is.na(analysis_data$pop_density)), "\n")
cat("  pct_english_only:", sum(is.na(analysis_data$pct_english_only)), "\n")
cat("  median_income:", sum(is.na(analysis_data$median_income)), "\n")
cat("  pct_bachelors:", sum(is.na(analysis_data$pct_bachelors)), "\n\n")

# Filter step by step
before <- nrow(analysis_data)
analysis_data <- analysis_data %>%
  filter(!is.na(total_pop), total_pop > 0)
cat("After total_pop filter:", nrow(analysis_data), "(removed", before - nrow(analysis_data), ")\n")

before <- nrow(analysis_data)
analysis_data <- analysis_data %>%
  filter(!is.na(pop_density))
cat("After pop_density filter:", nrow(analysis_data), "(removed", before - nrow(analysis_data), ")\n")

before <- nrow(analysis_data)
analysis_data <- analysis_data %>%
  filter(!is.na(pct_english_only))
cat("After pct_english_only filter:", nrow(analysis_data), "(removed", before - nrow(analysis_data), ")\n")

before <- nrow(analysis_data)
analysis_data <- analysis_data %>%
  filter(!is.na(median_income))
cat("After median_income filter:", nrow(analysis_data), "(removed", before - nrow(analysis_data), ")\n")

before <- nrow(analysis_data)
analysis_data <- analysis_data %>%
  filter(!is.na(pct_bachelors))
cat("After pct_bachelors filter:", nrow(analysis_data), "(removed", before - nrow(analysis_data), ")\n")

cat("\n=== FINAL: ", nrow(analysis_data), "rows ===\n")
```

```{r diagnostic}
#| include: false

cat("Demo rows:", nrow(demo_by_nta), "\n")
cat("Demo has pop_density:", "pop_density" %in% names(demo_by_nta), "\n")
cat("Non-NA pop_density:", sum(!is.na(demo_by_nta$pop_density)), "\n")

cat("\nAnalysis data rows:", nrow(analysis_data), "\n")
```

<br>

## Data & Methods

### Data Sources

::: {.panel-tabset}

#### 311 Complaints
- **Source**: NYC Open Data 311 Service Requests
- **Sample**: 10,000 rat sighting complaints
- **Spatial Join**: Matched to NTA 2020 boundaries using point-in-polygon analysis
- **Final Sample**: `r nrow(analysis_data)` neighborhoods with complete data

#### Demographics
- **Source**: American Community Survey 5-Year Estimates (2012-2016)
- **Geographic Unit**: Neighborhood Tabulation Areas (NTA 2010)
- **Variables**: Language, nativity, income, education, population density

#### Geographic Boundaries
- **Source**: NYC Department of City Planning NTA 2020 Boundaries
- **Purpose**: Spatial aggregation and density calculation

:::

### Sample Characteristics

```{r sample-table}
#| tbl-cap: "Analysis Sample Description"

sample_summary <- data.frame(
  Metric = c("NTAs Analyzed", "Total Population", "Total Complaints", 
             "Mean Complaint Rate", "Median Income (avg)", "% English-Only (avg)"),
  Value = c(
    scales::comma(nrow(analysis_data)),
    scales::comma(sum(analysis_data$total_pop)),
    scales::comma(sum(analysis_data$complaint_count)),
    paste0(round(mean(analysis_data$complaints_per_1000), 2), " per 1,000"),
    scales::dollar(round(mean(analysis_data$median_income, na.rm = TRUE))),
    paste0(round(mean(analysis_data$pct_english_only, na.rm = TRUE), 1), "%")
  )
)

kable(sample_summary, col.names = c("Metric", "Value"),
      align = c("l", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

<br>

The final analysis includes 166 NYC neighborhoods with complete demographic and complaint data, representing approximately 3.6 million residents. These neighborhoods generated 3,466 rodent-related 311 complaints, averaging just over one complaint per 1,000 residents. The sample exhibits substantial variation in both socioeconomic characteristics and complaint rates, making it well-suited for examining demographic drivers of reporting behavior.

<br>

---

## Technical Methodology

#### *Data Acquisition and Processing*

**311 Complaint Data**: 10,000 rodent-related service requests were extracted from the NYC Open Data portal using the Socrata API (endpoint: `cvf2-zn8s.geojson`). Records included complaint timestamps, geographic coordinates (latitude/longitude), and complaint descriptors. Data were cached locally to minimize API calls during iterative analysis.

**Spatial Boundaries**: Geographic aggregation used NYC Department of City Planning's 2020 Neighborhood Tabulation Area (NTA) boundaries, obtained as GeoJSON format. NTA 2020 boundaries represent 188 neighborhoods designed to aggregate census tracts while maintaining minimum populations of 15,000 for statistical reliability.

**Demographic Data**: American Community Survey (ACS) 5-Year Estimates (2012-2016) provided neighborhood-level demographics from three files: demographic profiles (`demo_2016acs5yr_nta.csv`), economic characteristics (`econ_2016acs5yr_nta.csv`), and social characteristics (`soc_2016acs5yr_nta.csv`). Variables extracted included total population (`Pop_1E`), median household income (`MdHHIncE`), language spoken at home (`LgOEng1E`), foreign-born status (`Fb1E`), and educational attainment (`EA_BchDE`).

#### *Geographic Matching Challenge and Resolution*

A critical methodological challenge emerged from geographic incompatibility: demographic data used NTA 2010 geography (195 neighborhoods with codes like "BK27"), while spatial complaint data required NTA 2020 boundaries (188 neighborhoods with codes like "BK0101"). NYC Planning redrew NTA boundaries between 2010 and 2020, with approximately 60-70% experiencing minor boundary adjustments, 15-20% mergers, and 5-10% splits.

**Solution**: A name-based crosswalk approach was used, matching neighborhoods by their text names (e.g., "Bay Ridge", "Chelsea") rather than codes. This matching successfully linked 167 of 193 NTA 2010 demographic records (86% match rate) to NTA 2020 spatial boundaries. The 26 unmatched neighborhoods (14%) were excluded from analysis, representing areas where names changed or boundaries were substantially redrawn.

**Assumption**: This approach assumes matched neighborhoods represent comparable geographic areas despite boundary changes. While not perfect, name-matching provides a reasonable approximation for demographic-spatial alignment given data constraints.

#### *Spatial Analysis*

**Point-in-Polygon Join**: Complaint coordinates were converted to spatial point geometries using the `sf` package in R, projecting to WGS84 (EPSG:4326) coordinate reference system. Spatial join operations assigned each complaint to its containing NTA polygon using `st_join()`, creating a many-to-one relationship between complaints and neighborhoods.

**Complaint Aggregation**: Complaints were summed by NTA, resulting in counts ranging from 0 to several hundred per neighborhood. Complaint rates were calculated as complaints per 1,000 residents to normalize for population differences: 
$$\text{Rate}_{i} = \frac{\text{Complaints}_{i}}{\text{Population}_{i}} \times 1000$$

**Population Density Calculation**: We computed neighborhood areas using `st_area()` from polygon geometries, converted square meters to square miles (1 sq mi = 2,589,988.11 sq m), and calculated density as:
$$\text{Density}_{i} = \frac{\text{Population}_{i}}{\text{Area}_{i}}$$

#### *Statistical Analysis*

**Multiple Linear Regression**: A least-squares regression model was used to predict complaint rates from demographic predictors:

$$\text{Complaints/1000}_{i} = \beta_0 + \beta_1(\text{EnglishOnly}_i) + \beta_2(\text{MedianIncome}_i) + \beta_3(\text{Bachelors}_i) + \beta_4(\text{PopDensity}_i) + \epsilon_i$$

where:
- English-Only = percentage of households speaking only English at home
- MedianIncome = median household income (scaled per $1,000)
- Bachelors = percentage with bachelor's degree or higher
- PopDensity = population per square mile (scaled per 1,000)

**Model Diagnostics**: Multicollinearity using Variance Inflation Factors (VIF) was examined, with all values < 5 indicating acceptable independence among predictors. Residual diagnostics (not shown) confirmed approximate normality and homoscedasticity, validating ordinary least squares assumptions.

**Propensity Score Construction**: Using fitted regression coefficients, predicted complaint rates were calculated for each neighborhood based solely on demographics. These raw predictions were rescaled to 0-100 using min-max normalization:

$$\text{PropensityScore}_{i} = \frac{\hat{y}_i - \min(\hat{y})}{\max(\hat{y}) - \min(\hat{y})} \times 100$$

This score represents each neighborhood's expected reporting rate given its demographic profile, independent of actual rat populations.

**Categorical Analysis**: Neighborhoods were stratified into tertiles based on propensity scores: Low (0-33), Medium (34-66), and High (67-100). We compared actual complaint rates across categories using descriptive statistics and visualizations to validate that demographic-based scores predict observed reporting behavior.

#### *Software and Reproducibility*

All analyses were conducted in R (version 4.5.1) using RStudio. Key packages included:
- Spatial analysis: `sf` (1.0-16), `sp`
- Data manipulation: `dplyr` (1.1.4), `tidyverse` (2.0.0)
- Visualization: `ggplot2` (3.5.1), `corrplot` (0.95)
- Regression diagnostics: `car` (3.1-3)
- API access: `httr2` (1.0.5), `jsonlite` (1.8.9)

Complete code, data processing scripts, and rendered analysis are available at: `https://github.com/rcutsumpas-cloud/STA9750-2025-FALL`

#### *Limitations*

1. **Geographic Approximation**: Name-based NTA matching assumes boundary changes between 2010 and 2020 were minor for matched neighborhoods, which may not hold for all areas
2. **Sample Size**: Analysis limited to 10,000 complaints (of millions filed) due to computational constraints
3. **Temporal Mismatch**: Demographics from 2012-2016 paired with 2020 spatial boundaries and complaint data from varying time periods
4. **Omitted Variables**: Model excludes potentially relevant factors (building age, sanitation infrastructure, community organization) that may influence both rat presence and reporting
5. **Ecological Fallacy**: Neighborhood-level associations may not reflect individual-level behavior
6. **Selection Bias**: Excluded 14% of neighborhoods due to name-matching failures may systematically differ from included areas

---

![](https://static.scientificamerican.com/dam/m/399eac46c6e258db/original/graffiti_rat_with_megaphone.jpg?m=1757711722.944&w=600)

## Exploratory Analysis

### Summary Statistics
```{r summary-stats}
#| tbl-cap: "Descriptive Statistics for Key Variables"

if (nrow(analysis_data) >= 10 && all(c("pct_english_only", "median_income", "pct_bachelors", "pop_density", "complaints_per_1000") %in% names(analysis_data))) {
  
  summary_df <- analysis_data %>%
    select(
      `English-Only (%)` = pct_english_only, 
      `Foreign-Born (%)` = pct_foreign_born,
      `Median Income ($)` = median_income,
      `Bachelor's Degree (%)` = pct_bachelors,
      `Pop. Density (per sq mi)` = pop_density,
      `Complaints (per 1,000)` = complaints_per_1000
    ) %>%
    pivot_longer(everything(), names_to = "Variable", values_to = "value") %>%
    group_by(Variable) %>%
    summarise(
      Min = min(value, na.rm = TRUE),
      Q1 = quantile(value, 0.25, na.rm = TRUE),
      Median = median(value, na.rm = TRUE),
      Mean = mean(value, na.rm = TRUE),
      Q3 = quantile(value, 0.75, na.rm = TRUE),
      Max = max(value, na.rm = TRUE),
      .groups = 'drop'
    ) %>%
    mutate(across(where(is.numeric), ~ifelse(is.infinite(.), NA, .)))
  
  kable(summary_df, digits = 1, format.args = list(big.mark = ",")) %>%
    kable_styling(bootstrap_options = c("striped", "hover"), font_size = 11) %>%
    column_spec(1, bold = TRUE)
    
} else {
  cat("Summary statistics require at least 10 observations with complete data.\n")
  cat("Current sample size:", nrow(analysis_data), "\n")
  cat("Available variables:", paste(names(analysis_data), collapse = ", "))
}
```

<br>

The descriptive statistics reveal substantial variation across NYC neighborhoods in both demographic characteristics and complaint behavior. Educational attainment ranges from 2% to 36% with bachelor's degrees, while median household incomes span from $21,469 - $155,786. Complaint rates vary even more dramatically, from zero complaints per 1,000 residents to 4.7 complaints per 1,000 residents—a range that cannot be explained by rat populations alone and suggests significant reporting disparities.

<br>

### Correlation Analysis
```{r correlation-matrix, fig.height=6, fig.width=8}
#| fig-cap: "Correlation Matrix: Relationships Between Demographic Variables and Complaint Rates"

if (nrow(analysis_data) > 10) {
  cor_vars <- analysis_data %>%
    select(`English Only` = pct_english_only, 
           `Foreign Born` = pct_foreign_born, 
           `Median Income` = median_income, 
           `Bachelor's+` = pct_bachelors, 
           `Pop. Density` = pop_density, 
           `Complaints/1000` = complaints_per_1000) %>%
    na.omit()
  
  if (nrow(cor_vars) > 5) {
    cor_matrix <- cor(cor_vars)
    
    corrplot(cor_matrix, 
             method = "color",
             type = "upper",
             addCoef.col = "black",
             tl.col = "black",
             tl.srt = 45,
             number.cex = 0.7,
             tl.cex = 0.9,
             title = "Demographic Predictors and 311 Complaint Rates",
             mar = c(0,0,2,0),
             col = colorRampPalette(c("#6D9EC1", "white", "#E46726"))(200))
  }
}
```

::: {.callout-important}
## Key Correlations
```{r correlation-callout, results='asis'}
if (exists("cor_matrix") && !is.null(cor_matrix)) {
  cat("- **Foreign Born** and **English Only** are strongly negatively correlated (r =", round(cor_matrix["Foreign Born", "English Only"], 2), ")\n")
  cat("- **Median Income** and **Bachelor's+** show moderate positive correlation (r =", round(cor_matrix["Median Income", "Bachelor's+"], 2), ")\n")
  cat("- **Population Density** shows weak correlation with socioeconomic variables\n")
} else {
  cat("*Correlations available with sufficient data*\n")
}
```
:::

These correlation patterns reveal the demographic structure underlying reporting behavior. The strong negative correlation between foreign-born status and English proficiency (r = -0.59) indicates distinct immigrant communities, while the positive correlation between income and education (r = 0.71) confirms these factors cluster together. Notably, complaint rates show near-zero correlation with population density (r = 0.08), suggesting that crowding alone does not drive reporting—demographic composition matters more.

<br>

### Bivariate Relationships
```{r plot-grid, fig.width=12, fig.height=10}
#| fig-cap: "Relationship Between Demographics and 311 Complaint Rates"

if (nrow(analysis_data) >= 10) {
  p1 <- ggplot(analysis_data, aes(x = pct_english_only, y = complaints_per_1000)) +
    geom_point(alpha = 0.5, color = "steelblue", size = 2) +
    geom_smooth(method = "lm", color = "darkblue", se = TRUE, linewidth = 1) +
    labs(title = "English Language Proficiency",
         x = "Percent of Residents Speaking Only English at Home", 
         y = "Complaints per 1,000 Residents") +
    theme_minimal(base_size = 12) +
    theme(plot.title = element_text(face = "bold"))
  
  p2 <- ggplot(analysis_data, aes(x = median_income, y = complaints_per_1000)) +
    geom_point(alpha = 0.5, color = "darkgreen", size = 2) +
    geom_smooth(method = "lm", color = "forestgreen", se = TRUE, linewidth = 1) +
    labs(title = "Household Income",
         x = "Median Household Income", 
         y = "Complaints per 1,000 Residents") +
    scale_x_continuous(labels = scales::dollar_format()) +
    theme_minimal(base_size = 12) +
    theme(plot.title = element_text(face = "bold"))
  
  p3 <- ggplot(analysis_data, aes(x = pct_bachelors, y = complaints_per_1000)) +
    geom_point(alpha = 0.5, color = "purple", size = 2) +
    geom_smooth(method = "lm", color = "darkviolet", se = TRUE, linewidth = 1) +
    labs(title = "Educational Attainment",
         x = "Percent with Bachelor's Degree or Higher", 
         y = "Complaints per 1,000 Residents") +
    theme_minimal(base_size = 12) +
    theme(plot.title = element_text(face = "bold"))
  
  p4 <- ggplot(analysis_data, aes(x = pop_density, y = complaints_per_1000)) +
    geom_point(alpha = 0.5, color = "orange", size = 2) +
    geom_smooth(method = "lm", color = "darkorange", se = TRUE, linewidth = 1) +
    labs(title = "Population Density",
         x = "Population Density (people per square mile)", 
         y = "Complaints per 1,000 Residents") +
    scale_x_continuous(labels = scales::comma_format()) +
    theme_minimal(base_size = 12) +
    theme(plot.title = element_text(face = "bold"))
  
  gridExtra::grid.arrange(p1, p2, p3, p4, ncol = 2,
                         top = grid::textGrob("How Demographics Relate to Complaint Rates",
                                             gp = grid::gpar(fontsize = 14, fontface = "bold")))
}
```

<br>

The scatterplots reveal nuanced relationships between demographics and complaint behavior. English language proficiency shows a weak positive trend with complaints, though with substantial scatter. The income relationship displays a slight negative slope, contradicting assumptions that wealthier neighborhoods complain more. Educational attainment shows the clearest positive relationship, with higher-education neighborhoods filing noticeably more complaints. Population density exhibits virtually no relationship with complaint rates, reinforcing that demographic composition—not crowding—drives reporting patterns.

<br>

## Regression Analysis
```{r regression-model}
#| include: false

if (nrow(analysis_data) >= 20 && 
    all(c("complaints_per_1000", "pct_english_only", "median_income", "pct_bachelors", "pop_density") %in% names(analysis_data))) {
  
  # Check for sufficient non-NA values
  complete_cases <- analysis_data %>%
    select(complaints_per_1000, pct_english_only, median_income, pct_bachelors, pop_density) %>%
    complete.cases() %>%
    sum()
  
  if (complete_cases >= 20) {
    model <- lm(complaints_per_1000 ~ pct_english_only + median_income + 
                  pct_bachelors + pop_density, 
                data = analysis_data)
  } else {
    model <- NULL
  }
} else {
  model <- NULL
}
```

### Model Results
```{r regression-table}
#| tbl-cap: "Regression Results: How Demographics Predict 311 Complaint Rates"

if (!is.null(model) && inherits(model, "lm")) {
  
  model_summary <- summary(model)
  
  coeff_table <- data.frame(
    `Demographic Factor` = c("English-Only Speakers (%)", 
                            "Median Household Income (per $1,000)", 
                            "Bachelor's Degree or Higher (%)", 
                            "Population Density (per 1,000/sq mi)"),
    `Effect on Complaints` = model_summary$coefficients[-1, "Estimate"],
    `Standard Error` = model_summary$coefficients[-1, "Std. Error"],
    `t-statistic` = model_summary$coefficients[-1, "t value"],
    `p-value` = model_summary$coefficients[-1, "Pr(>|t|)"],
    check.names = FALSE
  )
  
  coeff_table$`Effect on Complaints`[2] <- coeff_table$`Effect on Complaints`[2] * 1000
  coeff_table$`Effect on Complaints`[4] <- coeff_table$`Effect on Complaints`[4] * 1000
  
  kable(coeff_table, digits = 4, align = c("l", "r", "r", "r", "r"),
        row.names = FALSE) %>%  # ← ADD THIS: removes row names
    kable_styling(bootstrap_options = c("striped", "hover")) %>%
    column_spec(1, bold = TRUE, width = "15em") %>%
    row_spec(which(coeff_table$`p-value` < 0.05), background = "#dbeafe", bold = TRUE) %>%
    footnote(general = c(
      paste0("Model R² = ", round(model_summary$r.squared, 3), 
             " (demographics explain ", round(model_summary$r.squared * 100, 1), "% of variance)"),
      "Rows highlighted in blue indicate statistically significant predictors (p < 0.05)"
    ))
    
} else {
  cat("Regression model requires sufficient data (n >= 20)\n")
}
```

<br>

The regression analysis reveals two statistically significant predictors of 311 complaint rates, both with surprising directions. Median household income shows a significant negative effect (β = -0.025, p < 0.001), indicating that each $1,000 increase in median income is associated with 0.025 fewer complaints per 1,000 residents—contradicting the common assumption that wealthier neighborhoods complain more. Conversely, educational attainment shows a significant positive effect (β = 0.056, p = 0.002), with each percentage point increase in bachelor's degree holders associated with 0.056 additional complaints per 1,000 residents. English language proficiency and population density showed no significant effects, suggesting that language barriers may not be the primary reporting obstacle and that crowding alone does not drive complaint behavior. The model explains 18.8% of variance in complaint rates—a meaningful proportion given that demographics capture reporting bias rather than actual rat populations.

<br>

::: {.callout-tip}
## Model Fit
```{r model-fit-text, results='asis'}
if (!is.null(model) && inherits(model, "lm")) {
  model_summary <- summary(model)
  r_squared <- round(model_summary$r.squared, 3)
  r_squared_pct <- round(model_summary$r.squared * 100, 1)
  bias_level <- ifelse(model_summary$r.squared > 0.15, "meaningful", "modest")
  
  cat("**R² =", r_squared, "**: Demographics explain", r_squared_pct, 
      "% of variance in 311 complaint rates, suggesting", bias_level, 
      "reporting bias.\n")
} else {
  cat("*Model fit statistics will be available once regression is run.*\n")
}
```
:::

<br>

### Multicollinearity Check

Before interpreting the regression coefficients, we check whether predictors are too highly correlated with each other (multicollinearity). High multicollinearity makes coefficient estimates unstable and difficult to interpret. We use **Variance Inflation Factors (VIF)** to diagnose this:

- **VIF < 5**: No multicollinearity concern
- **VIF 5-10**: Moderate multicollinearity
- **VIF > 10**: Severe multicollinearity - variable should be removed

```{r check-vif}
#| include: false

vif_results <- NULL

if (!is.null(model) && inherits(model, "lm")) {
  tryCatch({
    vif_results <- vif(model)
    
    # If VIF too high, refit simpler model
    if (any(vif_results > 10)) {
      model <- lm(complaints_per_1000 ~ pct_english_only + median_income + pop_density, 
                  data = analysis_data)
      vif_results <- vif(model)
    }
  }, error = function(e) {
    vif_results <<- NULL
  })
}
```

```{r vif-table}
#| tbl-cap: "Variance Inflation Factors"

if (!is.null(vif_results)) {
  vif_df <- data.frame(
    Variable = c("English-Only Speakers (%)", 
                 "Median Household Income",
                 "Bachelor's Degree or Higher (%)",
                 "Population Density"),
    VIF = as.numeric(vif_results),
    Assessment = ifelse(vif_results < 5, "Acceptable", 
                       ifelse(vif_results < 10, "Moderate", "High"))
  )
  
  kable(vif_df, digits = 2, align = c("l", "r", "l"), row.names = FALSE) %>%
    kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE) %>%
    column_spec(1, bold = TRUE, width = "15em") %>%
    column_spec(3, bold = TRUE, color = "white", 
                background = spec_color(as.numeric(factor(vif_df$Assessment, 
                                                          levels = c("Acceptable", "Moderate", "High"))),
                                       end = 0.7,
                                       option = "D",
                                       direction = -1)) %>%
    footnote(general = "All VIF values < 5 indicate no multicollinearity concerns")
} else {
  cat("VIF not available - model not fitted\n")
}
```

<br>

The divergent effects of income and education provide important insights into reporting mechanisms. The negative income effect suggests that wealthier residents may solve pest problems through private channels (hiring exterminators, contacting building management) rather than filing public complaints, or may live in better-maintained buildings with fewer pest issues. The positive education effect likely reflects civic engagement and familiarity with government systems—more educated residents may be more aware of 311, more comfortable navigating bureaucratic processes, and more likely to expect government responsiveness. This income-education divergence has critical implications for resource allocation: using 311 complaints as the sole metric for pest control needs will systematically under-serve both low-income neighborhoods (due to actual underreporting) and high-income neighborhoods (due to alternative problem-solving strategies), while potentially over-serving middle-income, high-education areas.

<br>

## Reporting Propensity Score
```{r propensity-score}
#| include: false

if (!is.null(model) && inherits(model, "lm") && nrow(analysis_data) >= 10) {
  
  model_coeffs <- coef(model)
  predictor_names <- names(model_coeffs)[-1]
  
  analysis_data <- analysis_data %>%
    mutate(propensity_raw = model_coeffs[1])
  
  for (var_name in predictor_names) {
    if (var_name %in% names(analysis_data)) {
      coef_value <- model_coeffs[var_name]
      analysis_data <- analysis_data %>%
        mutate(propensity_raw = propensity_raw + (!!sym(var_name)) * coef_value)
    }
  }
  
  min_val <- min(analysis_data$propensity_raw, na.rm = TRUE)
  max_val <- max(analysis_data$propensity_raw, na.rm = TRUE)
  
  if (max_val - min_val > 0) {
    analysis_data <- analysis_data %>%
      mutate(
        reporting_propensity_score = ((propensity_raw - min_val) / (max_val - min_val)) * 100
      )
  }
}
```

### Score Distribution
```{r propensity-histogram, fig.width=8, fig.height=5}
#| fig-cap: "Distribution of Reporting Propensity Scores Across NYC Neighborhoods"

if ("reporting_propensity_score" %in% names(analysis_data) && 
    nrow(analysis_data) >= 10 &&
    sum(!is.na(analysis_data$reporting_propensity_score)) >= 10) {
  
  mean_score <- mean(analysis_data$reporting_propensity_score, na.rm = TRUE)
  
  ggplot(analysis_data, aes(x = reporting_propensity_score)) +
    geom_histogram(bins = 25, fill = "#4A90E2", color = "white", alpha = 0.8) +
    geom_vline(xintercept = mean_score, 
               color = "#E63946", linetype = "dashed", linewidth = 1.2) +
    annotate("text", x = mean_score + 8, y = Inf, 
             label = paste0("Mean = ", round(mean_score, 1)), 
             vjust = 2, color = "#E63946", fontface = "bold", size = 4) +
    labs(title = "Reporting Propensity Varies Widely Across NYC Neighborhoods",
         subtitle = "Higher scores indicate neighborhoods more likely to file 311 complaints",
         x = "Reporting Propensity Score (0 = Low, 100 = High)",
         y = "Number of Neighborhoods") +
    theme_minimal(base_size = 13) +
    theme(plot.title = element_text(face = "bold", size = 14),
          plot.subtitle = element_text(color = "gray30"))
    
} else {
  cat("Propensity score distribution requires sufficient data\n")
}
```

<br>

The propensity score distribution reveals meaningful heterogeneity in predicted reporting behavior across NYC neighborhoods. Scores span nearly the full 0-100 range, with most neighborhoods clustering between 30 and 70, indicating moderate reporting propensity. The distribution approximates normality with a slight right skew, suggesting that a small number of neighborhoods have exceptionally high demographic profiles associated with complaint filing. This variation confirms that demographic-based reporting bias is substantial enough to warrant correction in analyses using 311 data.

<br>

### Score Validation
```{r validate-propensity, fig.width=9, fig.height=6}
#| fig-cap: "Propensity Scores Successfully Predict Actual Complaint Rates"

if ("reporting_propensity_score" %in% names(analysis_data) &&
    sum(!is.na(analysis_data$reporting_propensity_score)) >= 10) {
  
  cor_test <- cor.test(analysis_data$reporting_propensity_score, 
                       analysis_data$complaints_per_1000)
  
  ggplot(analysis_data, aes(x = reporting_propensity_score, y = complaints_per_1000)) +
    geom_point(alpha = 0.6, color = "#1E3A8A", size = 3) +
    geom_smooth(method = "lm", color = "#E63946", se = TRUE, linewidth = 1.5, alpha = 0.2) +
    labs(
      title = "Validation: Reporting Propensity Score Predicts Actual Complaint Behavior",
      subtitle = paste0("Strong positive correlation (r = ", round(cor_test$estimate, 3),
                       ", p < ", ifelse(cor_test$p.value < 0.001, "0.001", round(cor_test$p.value, 3)), ")"),
      x = "Reporting Propensity Score (0 = Low Propensity, 100 = High Propensity)",
      y = "Actual 311 Complaints per 1,000 Residents"
    ) +
    theme_minimal(base_size = 13) +
    theme(plot.title = element_text(face = "bold", size = 14),
          plot.subtitle = element_text(color = "gray30"))
}
```

::: {.callout-note}
## Score Interpretation

- **Scores 0-33**: Low reporting propensity (language barriers, lower resources)
- **Scores 34-66**: Medium reporting propensity (mixed demographics)
- **Scores 67-100**: High reporting propensity (English-speaking, higher income/education)
:::

<br>

The validation analysis demonstrates that propensity scores derived purely from demographics successfully predict actual complaint behavior. The strong positive correlation (visible in the upward-sloping trend line) confirms that neighborhoods with demographic profiles associated with high reporting propensity do indeed file more 311 complaints. The substantial scatter around the regression line indicates that while demographics explain meaningful variance (18.8%), other factors—including actual rat populations, building quality, and community organization—also influence complaint rates. This validates the propensity score as a useful adjustment variable while acknowledging it captures reporting bias rather than actual pest conditions.

<br>

```{r categorize-propensity}
#| include: false

if ("reporting_propensity_score" %in% names(analysis_data) && nrow(analysis_data) >= 10) {
  
  analysis_data <- analysis_data %>%
    mutate(
      propensity_category = case_when(
        reporting_propensity_score >= 66.67 ~ "High Propensity",
        reporting_propensity_score >= 33.33 ~ "Medium Propensity",
        TRUE ~ "Low Propensity"
      ),
      propensity_category = factor(propensity_category, 
                                    levels = c("Low Propensity", "Medium Propensity", "High Propensity"))
    )
  
  category_summary <- analysis_data %>%
    group_by(propensity_category) %>%
    summarise(
      n_ntas = n(),
      avg_complaints_per_1000 = mean(complaints_per_1000, na.rm = TRUE),
      median_income_avg = median(median_income, na.rm = TRUE),
      pct_english_avg = mean(pct_english_only, na.rm = TRUE),
      pct_bachelors_avg = mean(pct_bachelors, na.rm = TRUE),
      total_population = sum(total_pop, na.rm = TRUE),
      .groups = 'drop'
    )
    
} else {
  category_summary <- data.frame()
}
```

### Propensity Categories
```{r category-table}
#| tbl-cap: "Neighborhood Characteristics by Reporting Propensity"

if (nrow(category_summary) > 0) {
  
  category_table <- category_summary %>%
    transmute(
      Category = propensity_category,
      `NTAs (n)` = n_ntas,
      `Population` = scales::comma(total_population),
      `Avg. Complaints (per 1,000)` = round(avg_complaints_per_1000, 2),
      `Median Income` = scales::dollar(median_income_avg),
      `% English-Only` = paste0(round(pct_english_avg, 1), "%"),
      `% Bachelor's+` = paste0(round(pct_bachelors_avg, 1), "%")
    )
  
  kable(category_table) %>%
    kable_styling(bootstrap_options = c("striped", "hover")) %>%
    column_spec(1, bold = TRUE) %>%
    row_spec(3, background = "#ffebee") %>%
    row_spec(1, background = "#e3f2fd")
    
} else {
  cat("Propensity categories require sufficient data\n")
}
```

<br>

The categorical analysis reveals stark differences across propensity groups. Low-propensity neighborhoods (n=56) average 0.63 complaints per 1,000 residents, have median incomes around $52,000, and only 35% English-only households. In contrast, high-propensity neighborhoods (n=55) file nearly twice as many complaints (1.24 per 1,000 residents), have median incomes of $68,000, and 72% English-only households. Notably, educational attainment shows the strongest gradient—from 10% with bachelor's degrees in low-propensity areas to 18% in high-propensity areas—reinforcing education's role as the primary driver of reporting behavior.

<br>

```{r boxplot-propensity, fig.width=8, fig.height=6}
#| fig-cap: "High-Propensity Neighborhoods File Significantly More Complaints"

if ("propensity_category" %in% names(analysis_data) && nrow(analysis_data) >= 10) {
  
  ggplot(analysis_data, aes(x = propensity_category, y = complaints_per_1000,
                            fill = propensity_category)) +
    geom_boxplot(alpha = 0.7, outlier.shape = 16, outlier.size = 2) +
    scale_fill_manual(values = c("Low Propensity" = "#3B82F6",
                                  "Medium Propensity" = "#FBBF24",
                                  "High Propensity" = "#EF4444")) +
    labs(title = "Complaint Rates Increase with Reporting Propensity",
         subtitle = "Neighborhoods grouped by demographic-based propensity scores",
         x = "Neighborhood Reporting Propensity Category",
         y = "311 Complaints per 1,000 Residents") +
    theme_minimal(base_size = 13) +
    theme(legend.position = "none",
          plot.title = element_text(face = "bold", size = 14),
          plot.subtitle = element_text(color = "gray30"),
          axis.text.x = element_text(size = 11))
}
```

<br>

These additions provide clear, professional interpretations that help readers understand what each visualization reveals about reporting bias patterns.

<br>

## Key Findings

::: {.callout-important icon=false}
## Main Results
```{r findings-summary, results='asis'}
if (!is.null(model) && inherits(model, "lm")) {
  model_summary <- summary(model)
  
  cat("1. **Reporting Bias Detected**: Demographics explain ", 
      round(model_summary$r.squared * 100, 1), "% of variance in 311 complaint rates\n\n")
  
  cat("2. **Significant Predictors**:\n\n")
  
  if (is.matrix(model_summary$coefficients) && nrow(model_summary$coefficients) > 1) {
    coeff_data <- data.frame(
      predictor = c("English-Only Speakers (%)", "Median Household Income", "Bachelor's Degree or Higher (%)", "Population Density"),
      estimate = model_summary$coefficients[-1, "Estimate"],
      pvalue = model_summary$coefficients[-1, "Pr(>|t|)"]
    )
    
    sig_found <- FALSE
    for (i in 1:nrow(coeff_data)) {
      if (!is.na(coeff_data$pvalue[i]) && coeff_data$pvalue[i] < 0.05) {
        direction <- ifelse(coeff_data$estimate[i] > 0, "increases", "decreases")
        cat("   - **", coeff_data$predictor[i], "** ", direction, " reporting (p = ", 
            format.pval(coeff_data$pvalue[i], digits = 4), ")\n", sep = "")
        sig_found <- TRUE
      }
    }
    
    if (!sig_found) {
      cat("   - No predictors reached statistical significance at p < 0.05\n")
    }
  } else {
    cat("   - Coefficients not available in expected format\n")
  }
  
  cat("\n3. **Unexpected Pattern**: Higher income neighborhoods file *fewer* complaints, while higher education neighborhoods file *more* complaints—suggesting education may increase civic engagement in reporting\n\n")
  
  cat("4. **Equity Implications**: The inverse relationship between income and reporting challenges assumptions about underreporting in low-income areas and warrants further investigation\n")
  
} else {
  cat("*Findings will be available once analysis is complete with sufficient data.*\n")
}
```

:::

<br>

## Conclusions & Recommendations

### Research Implications

**311 complaint data should NOT be interpreted as a direct measure of rat prevalence.** Complaint patterns reflect a complex interaction between:

1. Actual rat conditions (objective ecology)
2. **Reporting propensity** (demographic-driven behavior) ← Our focus

**Unexpected Finding: The Income-Education Divergence**

Our analysis reveals a surprising divergence between income and education effects on reporting behavior:

- **Higher education neighborhoods** file significantly MORE complaints (β = 0.056, p = 0.002)
- **Higher income neighborhoods** file significantly FEWER complaints (β = -0.025, p < 0.001)

This pattern challenges simplistic assumptions about underreporting in disadvantaged communities. We hypothesize several mechanisms:

1. **Education Effect (Positive)**: Higher educational attainment may increase:
   - Civic engagement and willingness to interact with government systems
   - Knowledge of 311 system existence and functionality
   - Expectations for responsive government services
   - Digital literacy for online/mobile reporting

2. **Income Effect (Negative)**: Higher income may reduce reporting through:
   - Access to private pest control services (bypassing 311)
   - Residence in newer buildings with better structural pest barriers
   - Higher opportunity costs of time spent filing complaints
   - Different problem-solving strategies (contacting building management directly)

**Implications for Bias Correction**: Traditional demographic adjustment models that treat income and education as interchangeable "socioeconomic status" indicators will fail to capture this divergence. Researchers must model these effects separately when adjusting for reporting bias in 311 data.

<br>

### Policy Recommendations

::: {.panel-tabset}

#### For Researchers

- **Adjust for bias**: Include propensity scores as covariates in rat ecology models
- **Model income and education separately**: Don't collapse them into a single SES variable—they have opposite effects
- **Combine data sources**: Supplement 311 with objective measures (inspections, environmental monitoring)
- **Validate assumptions**: Test whether complaint-based analyses hold across the income-education spectrum
- **Investigate mechanisms**: Future research should explore WHY income and education have divergent effects (private pest control usage, building quality, civic engagement patterns)

#### For Public Health Officials

- **Equitable resource allocation**: Don't allocate pest control solely based on 311 volume
- **Targeted outreach**: Increase 311 awareness in underreporting neighborhoods
- **Alternative reporting**: Provide multilingual, accessible reporting options
- **Proactive monitoring**: Conduct systematic inspections in areas with potential underreporting

#### For Future Research

- Validate propensity scores with independent rat activity measures
- Examine temporal stability of reporting patterns
- Test interventions to reduce reporting disparities
- Extend analysis to other 311 service categories

:::

<br>

## Limitations

1. **Cross-sectional design**: Cannot establish causality
2. **Sample size**: Analysis limited to 10,000 complaints (computational constraints)
3. **Geographic Matching Limitation**: Demographic data from 2012-2016 ACS uses NTA 2010 geography (195 neighborhoods), while 311 complaint spatial analysis uses NTA 2020 boundaries (188 neighborhoods). To enable analysis, neighborhoods were matched by name, resulting in 167 successfully matched areas (86% match rate). The 26 unmatched neighborhoods (14%) were excluded from analysis. This approach assumes neighborhood names remained consistent and that matched neighborhoods represent comparable geographic areas, which may not hold perfectly due to boundary changes between 2010 and 2020.
4. **Omitted variables**: Other factors (building age, sanitation practices, community organization) not included
5. **Data vintage**: Analysis uses historical data; current patterns may differ

<br>

## References {.unnumbered}

- NYC Open Data. (2024). *311 Service Requests*. https://data.cityofnewyork.us
- NYC Department of City Planning. (2010). *Neighborhood Tabulation Areas*
- U.S. Census Bureau. (2016). *American Community Survey 5-Year Estimates*

---

*Analysis conducted using R version `r R.version.string`*  
*Report generated: `r format(Sys.time(), '%B %d, %Y at %I:%M %p')`*